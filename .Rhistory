library(DBI)
library(RSQLite)
soccer <- dbConnect(SQLite(),
"/Users/kec_1/soccer/database.sqlite")
player <- dbReadTable(soccer, 'Player')
player_attr <- dbReadTable(soccer, 'Player_Attributes')
player <- as.data.frame(player)
player_attr <- as.data.frame(player_attr)
player_attr_2014 <- subset(player_attr, grepl("2014",date))
player_attr_2015 <- subset(player_attr, grepl("2015",date))
player[player < 0] <- NA
player_attr_2014[player_attr_2014 < 0] <- NA
player_attr_2015[player_attr_2015 < 0] <- NA
aggregate_process <- function(x) {
if (is.numeric(x)) {mean(x)}
else {x[1]}
}
player_attr_2014_aggregate <- aggregate(player_attr_2014,
by=list(player_attr_2014$player_api_id),
aggregate_process)
player_attr_2014 <-
player_attr_2014_aggregate[2:ncol(player_attr_2014_aggregate)]
player_attr_2015_aggregate <- aggregate(player_attr_2015,
by=list(player_attr_2015$player_api_id),
aggregate_process)
player_attr_2015 <-
player_attr_2015_aggregate[2:ncol(player_attr_2015_aggregate)]
preprocess <- function(data) {
for(i in 1:ncol(data)) {
if (is.numeric(data[,i]) && !grepl("id",names(data)[i])) {
mean <- mean(data[,i])
sd <- sd(data[,i])
data[,i] <- replace(data[,i],data[,i]>mean+2*sd,NA)
data[,i] <- replace(data[,i],data[,i]<mean-2*sd,NA)
data[,i] <- scale(data[,i])
}
}
return(data)
}
player <- preprocess(player)
player_attr_2014 <- preprocess(player_attr_2014)
player_attr_2015 <- preprocess(player_attr_2015)
View(player_attr_2014)
ncol(player_attr_2014)
x_var <- colnames(player_attr_2014)[6:42]
x_var
lm(overall_rating ~ x_var, data=player_attr_2014)
sum(x_var)
class(x_var)
